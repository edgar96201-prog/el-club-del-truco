<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>El Club del Truco â€“ Definitivo</title>
<style>
body { background:#0b3d2e; color:#fff; font-family:Georgia, serif; text-align:center; margin:0; }
h1 { margin:15px 0; }
.mesa { background:#145a32; border:6px solid #4a2c16; border-radius:20px; margin:20px auto; padding:15px; max-width:900px; }
.cartas { display:flex; justify-content:center; gap:12px; min-height:130px; flex-wrap:wrap; }
.carta { width:80px; height:120px; background:#fdf6e3; color:#000; border-radius:8px; display:flex; align-items:center; justify-content:center; font-size:16px; cursor:pointer; text-align:center; line-height:1.2; }
.rival .carta { background:#999; cursor: default; }
.botones button { margin:5px; padding:10px 15px; font-size:15px; border-radius:8px; border:none; cursor:pointer; }
.log { background:#0e6655; padding:10px; border-radius:10px; min-height:60px; margin-top:10px;}
</style>
</head>
<body>

<h1>ğŸƒ El Club del Truco â€“ Definitivo</h1>

<div class="mesa">
<h3>Puntaje</h3>
<p>Vos: <span id="pJugador">0</span> | Rival: <span id="pRival">0</span></p>

<h3>Rival</h3>
<div class="cartas rival" id="manoRival">
  <div class="carta" id="rival1">ğŸ‚ </div>
  <div class="carta" id="rival2">ğŸ‚ </div>
  <div class="carta" id="rival3">ğŸ‚ </div>
</div>

<h3>Mesa</h3>
<div class="cartas" id="mesa">
  <div class="carta" id="mesaJ1"></div>
  <div class="carta" id="mesaR1"></div>
</div>

<h3>Tu mano</h3>
<div class="cartas" id="manoJugador">
  <div class="carta" id="jugador1">ğŸ—¡ï¸ 1</div>
  <div class="carta" id="jugador2">ğŸª™ 7</div>
  <div class="carta" id="jugador3">ğŸ· 3</div>
</div>

<div class="log" id="log"></div>

<div class="botones">
  <button id="btnTruco">Truco</button>
  <button id="btnRetruco">Retruco</button>
  <button id="btnValeCuatro">Vale cuatro</button>
  <button id="btnEnvido">Envido</button>
  <button id="btnFlor">Flor</button>
  <button id="btnQuiero">Quiero</button>
  <button id="btnNoQuiero">No quiero</button>
  <button id="btnMazo">Mazo</button>
</div>
</div>

<script>
// ===== Datos =====
let cartasJugador = [
  {id:'jugador1', n:'1', p:'Espada', v:14},
  {id:'jugador2', n:'7', p:'Oro', v:11},
  {id:'jugador3', n:'3', p:'Copa', v:10}
];

let cartasRival = [
  {id:'rival1', n:'2', p:'Espada', v:9},
  {id:'rival2', n:'7', p:'Basto', v:4},
  {id:'rival3', n:'1', p:'Oro', v:8}
];

const simbolos = { 'Espada':'ğŸ—¡ï¸','Basto':'âš¾','Oro':'ğŸª™','Copa':'ğŸ·' };

let puntosJugador=0, puntosRival=0;
let trucoNivel=0; // 0=sin truco,1=Truco,2=Retruco,3=Vale4
let envidoActivo=false;
let florActivo=false;
let envidoPuntos=2, florPuntos=3;

// DOM
const logDiv = document.getElementById('log');
const pJ = document.getElementById('pJugador');
const pR = document.getElementById('pRival');

// ===== Funciones =====
function jugar(cartaJugador){
  if(cartasRival.length===0) return; // Evitar error
  const idxRival = Math.floor(Math.random() * cartasRival.length);
  const cartaRival = cartasRival.splice(idxRival,1)[0];

  document.getElementById('mesaJ1').textContent = simbolos[cartaJugador.p]+' '+cartaJugador.n;
  document.getElementById('mesaR1').textContent = simbolos[cartaRival.p]+' '+cartaRival.n;

  // Comparar cartas
  let puntosMano = trucoNivel || 1;
  if(cartaJugador.v > cartaRival.v){ puntosJugador+=puntosMano; logDiv.textContent=`Ganaste la mano +${puntosMano}`; }
  else if(cartaRival.v > cartaJugador.v){ puntosRival+=puntosMano; logDiv.textContent=`Rival gana la mano +${puntosMano}`; }
  else { logDiv.textContent='Mano parda'; }

  pJ.textContent=puntosJugador;
  pR.textContent=puntosRival;

  cartasJugador.splice(cartasJugador.indexOf(cartaJugador),1);
  document.getElementById(cartaJugador.id).textContent='';

  trucoNivel=0; // Reset truco despuÃ©s de mano

  setTimeout(()=>{
    if(puntosJugador>=30){ logDiv.textContent="Â¡GANASTE EL JUEGO!"; reiniciar(); }
    else if(puntosRival>=30){ logDiv.textContent="Â¡EL RIVAL GANA!"; reiniciar(); }
    else { siguienteMano(); }
  },800);
}

function siguienteMano(){
  document.getElementById('mesaJ1').textContent='';
  document.getElementById('mesaR1').textContent='';
  logDiv.textContent='Siguiente mano';
}

function reiniciar(){
  puntosJugador=0; puntosRival=0;
  pJ.textContent=0; pR.textContent=0;
  logDiv.textContent='Se reinicia el juego';
  repartirMano();
}

function repartirMano(){
  cartasJugador = [
    {id:'jugador1', n:'1', p:'Espada', v:14},
    {id:'jugador2', n:'7', p:'Oro', v:11},
    {id:'jugador3', n:'3', p:'Copa', v:10}
  ];
  cartasRival = [
    {id:'rival1', n:'2', p:'Espada', v:9},
    {id:'rival2', n:'7', p:'Basto', v:4},
    {id:'rival3', n:'1', p:'Oro', v:8}
  ];

  document.getElementById('jugador1').textContent='ğŸ—¡ï¸ 1';
  document.getElementById('jugador2').textContent='ğŸª™ 7';
  document.getElementById('jugador3').textContent='ğŸ· 3';

  document.getElementById('rival1').textContent='ğŸ‚ ';
  document.getElementById('rival2').textContent='ğŸ‚ ';
  document.getElementById('rival3').textContent='ğŸ‚ ';

  document.getElementById('mesaJ1').textContent='';
  document.getElementById('mesaR1').textContent='';
}

// ===== Botones cartas =====
document.getElementById('jugador1').addEventListener('click',()=>jugar(cartasJugador[0]));
document.getElementById('jugador2').addEventListener('click',()=>jugar(cartasJugador[1]));
document.getElementById('jugador3').addEventListener('click',()=>jugar(cartasJugador[2]));

// ===== Botones Truco / Envido / Flor =====
document.getElementById('btnTruco').addEventListener('click',()=>{ trucoNivel=1; logDiv.textContent='Cantaste Truco'; });
document.getElementById('btnRetruco').addEventListener('click',()=>{ if(trucoNivel>=1){ trucoNivel=2; logDiv.textContent='Cantaste Retruco'; }});
document.getElementById('btnValeCuatro').addEventListener('click',()=>{ if(trucoNivel>=2){ trucoNivel=3; logDiv.textContent='Cantaste Vale cuatro'; }});
document.getElementById('btnEnvido').addEventListener('click',()=>{ envidoActivo=true; logDiv.textContent='Cantaste Envido'; });
document.getElementById('btnFlor').addEventListener('click',()=>{ florActivo=true; logDiv.textContent='Cantaste Flor'; });

// ===== Botones Quiero / No quiero =====
document.getElementById('btnQuiero').addEventListener('click',()=>{
  if(envidoActivo){ puntosJugador+=envidoPuntos; pJ.textContent=puntosJugador; logDiv.textContent='Aceptaste Envido +'+envidoPuntos; envidoActivo=false; }
  else if(florActivo){ puntosJugador+=florPuntos; pJ.textContent=puntosJugador; logDiv.textContent='Aceptaste Flor +'+florPuntos; florActivo=false; }
});
document.getElementById('btnNoQuiero').addEventListener('click',()=>{
  if(envidoActivo){ logDiv.textContent='No quisiste Envido'; envidoActivo=false; puntosRival+=envidoPuntos; pR.textContent=puntosRival; }
  else if(florActivo){ logDiv.textContent='No quisiste Flor'; florActivo=false; puntosRival+=florPuntos; pR.textContent=puntosRival; }
});
document.getElementById('btnMazo').addEventListener('click',reiniciar);

repartirMano();
</script>
</body>
</html>
