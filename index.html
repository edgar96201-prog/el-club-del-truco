<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>El Club del Truco ‚Äì Demo 1vs1</title>
<style>
body { margin:0; font-family: Georgia, serif; background:#0b3d2e; color:#fff; text-align:center;}
h1 { margin:15px 0; }
.menu, .mesa { max-width: 900px; margin:20px auto; }
.menu input, .menu select { margin:5px; padding:8px; font-size:16px; }
.menu button { margin:10px; padding:12px 25px; font-size:16px; border-radius:8px; cursor:pointer; }
.mesa { display:none; background:#145a32; border:6px solid #4a2c16; border-radius:20px; padding:15px; }
.cartas { display:flex; justify-content:center; gap:12px; min-height:130px; flex-wrap:wrap; }
.carta { width:80px; height:120px; border-radius:8px; display:flex; align-items:center; justify-content:center; cursor:pointer; overflow:hidden; background:#fdf6e3; }
.carta img { width:100%; height:100%; object-fit:cover; }
.rival .carta { cursor: default; }
.botones button { margin:5px; padding:8px 12px; font-size:14px; border-radius:8px; cursor:pointer; }
.log { background:#0e6655; padding:10px; border-radius:10px; min-height:80px; margin-top:10px;}
#temporizador { font-size:16px; font-weight:bold; margin-top:5px; }
#tantoJugador, #tantoRival { font-weight:bold; margin-top:5px; }
</style>
</head>
<body>

<h1>üÉè El Club del Truco</h1>

<div class="menu" id="menuModalidad">
  <label>Tu nombre: <input type="text" id="nombreJugador" placeholder="Jugador"></label><br>
  <label>Modo de juego:
    <select id="modoJuego">
      <option value="1">1 vs 1</option>
      <option value="2">2 vs 2 (Pr√≥ximamente)</option>
      <option value="3">3 vs 3 (Pr√≥ximamente)</option>
    </select>
  </label><br>
  <label>Flor:
    <select id="conFlor">
      <option value="si">Con Flor</option>
      <option value="no">Sin Flor</option>
    </select>
  </label><br>
  <label>Puntaje m√°ximo:
    <select id="puntajeMax">
      <option value="15">15 puntos</option>
      <option value="30">30 puntos</option>
    </select>
  </label><br>
  <button id="btnIniciar">Iniciar partida</button>
</div>

<div class="mesa" id="mesaJuego">
<h3>Puntaje</h3>
<p><span id="nombreJugadorDisplay">Jugador</span>: <span id="pJugador">0</span> | Rival: <span id="pRival">0</span></p>
<p id="tantoJugador">Tus tantos: 0</p>
<p id="tantoRival">Tantos rival: 0</p>

<h3>Rival</h3>
<div class="cartas rival" id="manoRival">
  <div class="carta" id="cartaRival1"></div>
  <div class="carta" id="cartaRival2"></div>
  <div class="carta" id="cartaRival3"></div>
</div>

<h3>Mesa</h3>
<div class="cartas" id="mesa">
  <div class="carta" id="mesaJ"></div>
  <div class="carta" id="mesaR"></div>
</div>

<h3>Tu mano</h3>
<div class="cartas" id="manoJugador">
  <div class="carta" id="jugador1"></div>
  <div class="carta" id="jugador2"></div>
  <div class="carta" id="jugador3"></div>
</div>

<div id="temporizador">Tiempo restante: <span id="timer">15</span> s</div>
<div class="log" id="log"></div>

<div class="botones">
  <button id="btnTruco">Truco</button>
  <button id="btnRetruco">Retruco</button>
  <button id="btnValeCuatro">Vale cuatro</button>
  <button id="btnEnvido">Envido</button>
  <button id="btnFlor">Flor</button>
  <button id="btnQuiero">Quiero</button>
  <button id="btnNoQuiero">No quiero</button>
  <button id="btnMazo">Ir al mazo</button>
</div>
</div>

<script>
// ===== Baraja =====
const baraja=[];
const palos=['Espada','Basto','Oro','Copa'];
const numeros=[1,2,3,4,5,6,7,10,11,12];
numeros.forEach(n=>palos.forEach(p=>baraja.push({n,p,v:n})));

let manoJugador=[], manoRival=[], puntosJugador=0, puntosRival=0;
let tantosJugador=0, tantosRival=0;
let turno='jugador', timerInterval, tiempo=15;
let rondaActual=0, puntajeMax=15;

// ===== Voz =====
const synth = window.speechSynthesis;
function hablar(texto){
  const msg = new SpeechSynthesisUtterance();
  msg.text = texto;
  msg.lang = 'es-AR';
  synth.speak(msg);
}

// ===== Efectos =====
const sonidoCarta = new Audio('https://actions.google.com/sounds/v1/cartoon/card_flip.ogg');
const sonidoMazo = new Audio('https://actions.google.com/sounds/v1/cartoon/shuffle_cards.ogg');
function reproducirCarta(){ sonidoCarta.play(); }
function reproducirMazo(){ sonidoMazo.play(); }

// ===== Barajar =====
function barajar(array){ let a=array.slice(); for(let i=a.length-1;i>0;i--){ let j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]];} return a;}

// ===== Repartir =====
function repartir(){
  reproducirMazo();
  let b=barajar(baraja);
  manoJugador=b.splice(0,3);
  manoRival=b.splice(0,3);
  for(let i=0;i<3;i++){
    document.getElementById('jugador'+(i+1)).innerHTML=`<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/3d/${manoJugador[i].n}de${manoJugador[i].p.toLowerCase()}.png/80px-${manoJugador[i].n}de${manoJugador[i].p.toLowerCase()}.png">`;
    document.getElementById('cartaRival'+(i+1)).innerHTML=`<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/55/Card_back_40.png/80px-Card_back_40.png">`;
  }
  document.getElementById('mesaJ').innerHTML='';
  document.getElementById('mesaR').innerHTML='';
  rondaActual=0; turno='jugador'; iniciarTurno();
  log('Cartas repartidas. Es tu turno.');
}

// ===== Turno =====
function iniciarTurno(){
  tiempo=15; document.getElementById('timer').textContent=tiempo;
  clearInterval(timerInterval);
  timerInterval=setInterval(()=>{
    tiempo--; document.getElementById('timer').textContent=tiempo;
    if(tiempo<=0){ clearInterval(timerInterval); if(turno==='jugador'){ jugarCartaJugador(0);} }
  },1000);
}

// ===== Jugar cartas =====
function jugarCartaJugador(indice){
  if(turno!=='jugador') return;
  let carta=manoJugador.splice(indice,1)[0];
  document.getElementById('mesaJ').innerHTML=`<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/3d/${carta.n}de${carta.p.toLowerCase()}.png/80px-${carta.n}de${carta.p.toLowerCase()}.png">`;
  reproducirCarta(); hablar(`Jugaste ${carta.n} de ${carta.p}`);
  turno='rival'; setTimeout(jugarCartaRival,1000);
}

function jugarCartaRival(){
  if(turno!=='rival') return;
  let carta=manoRival.shift();
  document.getElementById('mesaR').innerHTML=`<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/3d/${carta.n}de${carta.p.toLowerCase()}.png/80px-${carta.n}de${carta.p.toLowerCase()}.png">`;
  reproducirCarta(); hablar(`Rival jug√≥ su carta`);
  turno='jugador'; evaluarRonda();
}

// ===== Evaluar ronda =====
function evaluarRonda(){
  rondaActual++;
  // Demo simple: gana jugador siempre
  puntosJugador++; document.getElementById('pJugador').textContent=puntosJugador;
  document.getElementById('tantoJugador').textContent=`Tus tantos: ${puntosJugador}`;
  if(rondaActual<3){ setTimeout(iniciarTurno,1000); }
  else { log('Fin de la mano. Puntaje actualizado.'); setTimeout(repartir,2000); }
}

// ===== Log =====
function log(mensaje){ document.getElementById('log').textContent=mensaje; }

// ===== Eventos botones =====
for(let i=0;i<3;i++){ document.getElementById('jugador'+(i+1)).addEventListener('click',()=>jugarCartaJugador(i)); }
document.getElementById('btnIniciar').addEventListener('click',()=>{
  document.getElementById('menuModalidad').style.display='none';
  document.getElementById('mesaJuego').style.display='block';
  document.getElementById('nombreJugadorDisplay').textContent=document.getElementById('nombreJugador').value||'Jugador';
  puntajeMax=parseInt(document.getElementById('puntajeMax').value);
  repartir();
});

document.getElementById('btnMazo').addEventListener('click',()=>{ repartir(); hablar('Me voy al mazo'); });
document.getElementById('btnTruco').addEventListener('click',()=>{ hablar('Truco'); log('Cantaste Truco'); });
document.getElementById('btnRetruco').addEventListener('click',()=>{ hablar('Retruco'); log('Cantaste Retruco'); });
document.getElementById('btnValeCuatro').addEventListener('click',()=>{ hablar('Vale cuatro'); log('Cantaste Vale cuatro'); });
document.getElementById('btnEnvido').addEventListener('click',()=>{ hablar('Envido'); log('Cantaste Envido'); });
document.getElementById('btnFlor').addEventListener('click',()=>{ hablar('Flor'); log('Cantaste Flor'); });
document.getElementById('btnQuiero').addEventListener('click',()=>{ hablar('Quiero'); log('Dijiste Quiero'); });
document.getElementById('btnNoQuiero').addEventListener('click',()=>{ hablar('No quiero'); log('Dijiste No Quiero'); });
</script>
</body>
</html>
