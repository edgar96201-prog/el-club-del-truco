<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>El Club del Truco ‚Äì 2vs2 Estrat√©gico</title>
<style>
body { background:#0b3d2e; color:#fff; font-family:Georgia, serif; text-align:center; margin:0; }
h1 { margin:15px 0; }
.mesa { background:#145a32; border:6px solid #4a2c16; border-radius:20px; margin:20px auto; padding:15px; max-width:900px; }
.cartas { display:flex; justify-content:center; gap:12px; min-height:130px; flex-wrap:wrap; }
.carta { width:80px; height:120px; background:#fdf6e3; color:#000; border-radius:8px; display:flex; align-items:center; justify-content:center; font-size:16px; cursor:pointer; text-align:center; line-height:1.2; }
.rival .carta { background:#999; cursor: default; }
.botones button { margin:5px; padding:10px 15px; font-size:15px; border-radius:8px; border:none; cursor:pointer; }
.log { background:#0e6655; padding:10px; border-radius:10px; min-height:80px; margin-top:10px;}
</style>
</head>
<body>

<h1>üÉè El Club del Truco ‚Äì 2vs2 Estrat√©gico</h1>

<div class="mesa">
<h3>Puntaje</h3>
<p>Tu equipo: <span id="pEquipo">0</span> | Equipo rival: <span id="pRival">0</span></p>

<h3>Rivales</h3>
<div class="cartas rival" id="manoRival">
  <div class="carta" id="rival1">üÇ†</div>
  <div class="carta" id="rival2">üÇ†</div>
</div>

<h3>Mesa</h3>
<div class="cartas" id="mesa">
  <div class="carta" id="mesaJ1"></div>
  <div class="carta" id="mesaJ2"></div>
  <div class="carta" id="mesaR1"></div>
  <div class="carta" id="mesaR2"></div>
</div>

<h3>Tu mano</h3>
<div class="cartas" id="manoJugador">
  <div class="carta" id="jugador1"></div>
  <div class="carta" id="jugador2"></div>
  <div class="carta" id="jugador3"></div>
</div>

<div class="log" id="log"></div>

<div class="botones">
  <button id="btnTruco">Truco</button>
  <button id="btnRetruco">Retruco</button>
  <button id="btnValeCuatro">Vale cuatro</button>
  <button id="btnEnvido">Envido</button>
  <button id="btnFlor">Flor</button>
  <button id="btnQuiero">Quiero</button>
  <button id="btnNoQuiero">No quiero</button>
  <button id="btnMazo">Mazo</button>
</div>
</div>

<script>
// ===== Sonidos =====
function reproducirSonido(nombre){
  const audio = new Audio(nombre);
  audio.play();
}

// ===== Baraja y valores =====
const baraja = [
  {n:'1',p:'Espada',v:14},{n:'1',p:'Basto',v:13},{n:'7',p:'Espada',v:12},{n:'7',p:'Oro',v:11},
  {n:'3',p:'Espada',v:10},{n:'3',p:'Basto',v:10},{n:'3',p:'Oro',v:10},{n:'3',p:'Copa',v:10},
  {n:'2',p:'Espada',v:9},{n:'2',p:'Basto',v:9},{n:'2',p:'Oro',v:9},{n:'2',p:'Copa',v:9},
  {n:'1',p:'Oro',v:8},{n:'1',p:'Copa',v:8},{n:'12',p:'Espada',v:7},{n:'12',p:'Basto',v:7},
  {n:'12',p:'Oro',v:7},{n:'12',p:'Copa',v:7},{n:'11',p:'Espada',v:6},{n:'11',p:'Basto',v:6},
  {n:'11',p:'Oro',v:6},{n:'11',p:'Copa',v:6},{n:'10',p:'Espada',v:5},{n:'10',p:'Basto',v:5},
  {n:'10',p:'Oro',v:5},{n:'10',p:'Copa',v:5},{n:'7',p:'Basto',v:4},{n:'7',p:'Copa',v:4},
  {n:'6',p:'Espada',v:3},{n:'6',p:'Basto',v:3},{n:'6',p:'Oro',v:3},{n:'6',p:'Copa',v:3},
  {n:'5',p:'Espada',v:2},{n:'5',p:'Basto',v:2},{n:'5',p:'Oro',v:2},{n:'5',p:'Copa',v:2},
  {n:'4',p:'Espada',v:1},{n:'4',p:'Basto',v:1},{n:'4',p:'Oro',v:1},{n:'4',p:'Copa',v:1}
];
const simbolos = { 'Espada':'üó°Ô∏è','Basto':'‚öæ','Oro':'ü™ô','Copa':'üç∑' };

let puntosEquipo=0, puntosRival=0;
let trucoNivel=0;
let envidoActivo=false;
let florActivo=false;
let rondaActual=0;

let manoJugador=[], manoCompa√±ero=[], manoRival=[];

// DOM
const logDiv = document.getElementById('log');
const pE = document.getElementById('pEquipo');
const pR = document.getElementById('pRival');

// ===== Funciones =====
function barajar(array){
  let a = array.slice();
  for(let i=a.length-1;i>0;i--){
    let j=Math.floor(Math.random()*(i+1));
    [a[i],a[j]]=[a[j],a[i]];
  }
  return a;
}

function repartirMano(){
  let barajaAct = barajar(baraja);
  manoJugador = barajaAct.splice(0,3);
  manoCompa√±ero = barajaAct.splice(0,3);
  manoRival = barajaAct.splice(0,4);

  for(let i=0;i<3;i++){
    document.getElementById('jugador'+(i+1)).textContent = simbolos[manoJugador[i].p]+' '+manoJugador[i].n;
  }

  document.getElementById('mesaJ1').textContent='';
  document.getElementById('mesaJ2').textContent='';
  document.getElementById('mesaR1').textContent='üÇ†';
  document.getElementById('mesaR2').textContent='üÇ†';

  rondaActual=0;
  logDiv.textContent='Se repartieron cartas aleatorias';
}

// ===== Juego de cartas por rondas =====
function jugarCarta(indice){
  if(rondaActual>=3) return;
  let cartaJugador = manoJugador.splice(indice,1)[0];
  let cartaComp = manoCompa√±ero.shift();
  let cartaR1 = manoRival.splice(0,1)[0];
  let cartaR2 = manoRival.splice(0,1)[0];

  document.getElementById('mesaJ1').textContent = simbolos[cartaJugador.p]+' '+cartaJugador.n;
  document.getElementById('mesaJ2').textContent = simbolos[cartaComp.p]+' '+cartaComp.n;
  document.getElementById('mesaR1').textContent = simbolos[cartaR1.p]+' '+cartaR1.n;
  document.getElementById('mesaR2').textContent = simbolos[cartaR2.p]+' '+cartaR2.n;

  rondaActual++;

  let equipoGana=0, rivalGana=0;
  [[cartaJugador,cartaR1],[cartaComp,cartaR2]].forEach(par=>{
    if(par[0].v>par[1].v) equipoGana++;
    else if(par[1].v>par[0].v) rivalGana++;
  });

  if(rondaActual===3){
    let puntosMano = trucoNivel || 1;
    if(equipoGana>rivalGana){ puntosEquipo+=puntosMano; logDiv.textContent='Tu equipo gana la mano +'+puntosMano; }
    else if(rivalGana>equipoGana){ puntosRival+=puntosMano; logDiv.textContent='Rival gana la mano +'+puntosMano; }
    else { logDiv.textContent='Mano parda'; }

    pE.textContent=puntosEquipo;
    pR.textContent=puntosRival;

    trucoNivel=0;

    setTimeout(()=>{
      if(puntosEquipo>=30){ reproducirSonido('mazo.mp3'); logDiv.textContent="¬°GANASTE EL JUEGO!"; reiniciar(); }
      else if(puntosRival>=30){ reproducirSonido('mazo.mp3'); logDiv.textContent="¬°EL RIVAL GANA!"; reiniciar(); }
      else siguienteMano();
    },1200);
  }
}

function siguienteMano(){
  document.getElementById('mesaJ1').textContent='';
  document.getElementById('mesaJ2').textContent='';
  document.getElementById('mesaR1').textContent='üÇ†';
  document.getElementById('mesaR2').textContent='üÇ†';
  logDiv.textContent='Siguiente mano';
}

function reiniciar(){
  puntosEquipo=0; puntosRival=0;
  pE.textContent=0; pR.textContent=0;
  repartirMano();
}

// ===== Botones cartas =====
document.getElementById('jugador1').addEventListener('click',()=>jugarCarta(0));
document.getElementById('jugador2').addEventListener('click',()=>jugarCarta(1));
document.getElementById('jugador3').addEventListener('click',()=>jugarCarta(2));

// ===== Botones Truco / Envido / Flor con sonidos =====
document.getElementById('btnTruco').addEventListener('click',()=>{ reproducirSonido('truco.mp3'); trucoNivel=1; logDiv.textContent='Cantaste Truco'; });
document.getElementById('btnRetruco').addEventListener('click',()=>{ if(trucoNivel>=1){ reproducirSonido('retruco.mp3'); trucoNivel=2; logDiv.textContent='Cantaste Retruco'; }});
document.getElementById('btnValeCuatro').addEventListener('click',()=>{ if(trucoNivel>=2){ reproducirSonido('vale4.mp3'); trucoNivel=3; logDiv.textContent='Cantaste Vale cuatro'; }});
document.getElementById('btnEnvido').addEventListener('click',()=>{
  reproducirSonido('envido.mp3'); 
  envidoActivo=true;
  let rivalSuma = (manoRival[0]?.v||0) + (manoRival[1]?.v||0);
  let respuesta = rivalSuma>=20?'Quiero':'No quiero';
  logDiv.textContent=`Cantaste Envido - Rival dice: ${respuesta}`;
  if(respuesta==='Quiero'){ puntosEquipo+=2; pE.textContent=puntosEquipo; } else { puntosRival+=2; pR.textContent=puntosRival; }
});
document.getElementById('btnFlor').addEventListener('click',()=>{ reproducirSonido('flor.mp3'); florActivo=true; logDiv.textContent='Cantaste Flor'; });

document.getElementById('btnQuiero').addEventListener('click',()=>{
  reproducirSonido('quiero.mp3');
  if(envidoActivo){ puntosEquipo+=2; pE.textContent=puntosEquipo; envidoActivo=false; logDiv.textContent='Aceptaste Envido'; }
  if(florActivo){ puntosEquipo+=3; pE.textContent=puntosEquipo; florActivo=false; logDiv.textContent='Aceptaste Flor'; }
});
document.getElementById('btnNoQuiero').addEventListener('click',()=>{
  reproducirSonido('noquiero.mp3');
  if(envidoActivo){ puntosRival+=2; pR.textContent=puntosRival; envidoActivo=false; logDiv.textContent='No quisiste Envido'; }
  if(florActivo){ puntosRival+=3; pR.textContent=puntosRival; florActivo=false; logDiv.textContent='No quisiste Flor'; }
});
document.getElementById('btnMazo').addEventListener('click',()=>{
  reproducirSonido('mazo.mp3'); 
  reiniciar();
});

repartirMano();
</script>
</body>
</html>
