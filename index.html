<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>El Club del Truco</title>
<style>
body {
  background:#0b3d2e;
  color:#fff;
  font-family:Georgia, serif;
  text-align:center;
  margin:0;
}
h1 { margin:15px 0; }
.mesa {
  background:#145a32;
  border:6px solid #4a2c16;
  border-radius:20px;
  margin:20px auto;
  padding:15px;
  max-width:900px;
}
.cartas {
  display:flex;
  justify-content:center;
  gap:12px;
  min-height:130px;
}
.carta {
  width:80px;
  height:120px;
  background:#fdf6e3;
  color:#000;
  border-radius:8px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:15px;
  cursor:pointer;
}
.rival .carta {
  background:#999;
}
.log {
  background:#0e6655;
  padding:10px;
  border-radius:10px;
  min-height:50px;
  margin-top:10px;
}
</style>
</head>

<body>

<h1>üÉè El Club del Truco ‚Äì Hasta 30 puntos</h1>

<div class="mesa">

<h3>Puntaje</h3>
<p>Vos: <span id="pJugador">0</span> | Rival: <span id="pRival">0</span></p>

<h3>Rival</h3>
<div class="cartas rival" id="manoRival"></div>

<h3>Mesa</h3>
<div class="cartas" id="mesa"></div>

<h3>Tu mano</h3>
<div class="cartas" id="manoJugador"></div>

<div class="log" id="log"></div>

<div style="margin-top:10px;">
  <button onclick="repartir()">Repartir</button>
</div>

</div>

<script>
// ====== DATOS ======
const valores = {
 "1 Espada":14,"1 Basto":13,"7 Espada":12,"7 Oro":11,
 "3":10,"2":9,"1":8,"12":7,"11":6,"10":5,
 "7":4,"6":3,"5":2,"4":1
};
const mazoBase = Object.keys(valores);

let manoJugador=[], manoRival=[];
let puntosJugador=0, puntosRival=0;

// ====== DOM ======
const mj = document.getElementById("manoJugador");
const mr = document.getElementById("manoRival");
const mesa = document.getElementById("mesa");
const logDiv = document.getElementById("log");
const pJ = document.getElementById("pJugador");
const pR = document.getElementById("pRival");

// ====== FUNCIONES ======
function mezclar(arr){ return arr.sort(()=>Math.random()-0.5); }

function repartir(){
  mj.innerHTML=""; mr.innerHTML=""; mesa.innerHTML="";
  logDiv.innerText="Se repartieron las cartas";

  const mazo = mezclar([...mazoBase]);
  manoJugador = mazo.slice(0,3);
  manoRival = mazo.slice(3,6);

  manoJugador.forEach(c=>{
    const d=document.createElement("div");
    d.className="carta";
    d.innerText=c;
    d.onclick=()=>jugar(c,d);
    mj.appendChild(d);
  });

  manoRival.forEach(()=>{
    const d=document.createElement("div");
    d.className="carta";
    d.innerText="üÇ†";
    mr.appendChild(d);
  });
}

function jugar(carta,div){
  mj.removeChild(div);
  mesa.innerHTML="";

  const cRival = manoRival.pop();
  mr.removeChild(mr.firstChild);

  const dJ = document.createElement("div");
  dJ.className="carta";
  dJ.innerText=carta;

  const dR = document.createElement("div");
  dR.className="carta";
  dR.innerText=cRival;

  mesa.appendChild(dJ);
  mesa.appendChild(dR);

  const vJ = valores[carta];
  const vR = valores[cRival];

  if(vJ > vR){
    puntosJugador++;
    logDiv.innerText = "Ganaste la mano";
  } else if(vR > vJ){
    puntosRival++;
    logDiv.innerText = "Gan√≥ el rival";
  } else {
    logDiv.innerText = "Mano parda";
  }

  pJ.innerText = puntosJugador;
  pR.innerText = puntosRival;

  setTimeout(()=>{ 
    if(puntosJugador>=30){
      logDiv.innerText="¬°GANASTE EL JUEGO!";
      reiniciarPuntos();
    } else if(puntosRival>=30){
      logDiv.innerText="¬°EL RIVAL GANA EL JUEGO!";
      reiniciarPuntos();
    } else {
      repartir();
    }
  }, 1200);
}

function reiniciarPuntos(){
  puntosJugador=0;
  puntosRival=0;
  pJ.innerText=0;
  pR.innerText=0;
  repartir();
}

// ====== INICIO ======
repartir();
</script>

</body>
</html>
